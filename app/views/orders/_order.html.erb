<!-- app/views/orders/_order.html.erb -->
<div class="columns-2">
  <div class="h-full" id="<%= dom_id order %>">
    <h2>Order ID: <%= order.id %></h2>
    <p>Doctor: <%= render partial: "doctor", locals: { doctor: order.doctor } %></p>
    <p>Total: <%= order.total %></p>
    <%= render partial: "order_item", collection: eval(order.order_items) %>
    <p>Created At: <%= order.created_at %></p>
    <p>Updated At: <%= order.updated_at %></p>
  </div>
  <div class="h-full">
    <div id="messages" class="flex flex-col gap-4">
      <% order.messages.visible_to(current_user).each do |message| %>
        <div class="bg-white p-4 rounded-lg shadow-md">
          <p><strong>From:</strong> <%= message.user&.email || "System" %></p>
          <p><strong>To:</strong> <%= message.recipient&.email || "Customer Care" %></p>
          <p class="text-gray-800"><%= message.message %></p>
          <p class="text-gray-500 text-sm"><%= message.created_at.strftime("%B %d, %Y %I:%M %p") %></p>
        </div>
      <% end %>
    </div>
    <%= render partial: "messages/form", locals: { order: order } %>
  </div>
</div>
